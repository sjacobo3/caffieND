{% extends "base.html" %}

{% block title %}Leaderboard{% endblock %}

{% block content %}

<form action="/leaderboard" method="GET" class="mb-4">
    <div class="input-group">
        <select class="form-select" name="leadertype">
            <option value="overall" {% if leadertype=='overall' %} selected {% endif %}>Overall</option>
            <option value="coffee" {% if leadertype=='coffee' %} selected {% endif %}>Coffee</option>
            <option value="tea" {% if leadertype=='tea' %} selected {% endif %}>Tea</option>
            <option value="energy" {% if leadertype=='energy' %} selected {% endif %}>Energy</option>
            <option value="water" {% if leadertype=='water' %} selected {% endif %}>Water</option>
            <option value="brands" {% if leadertype=='brands' %} selected {% endif %}>Brands</option>
        </select>

        <button class="btn btn-primary" type="submit">Search</button>
    </div>
</form>


<!-- Leaderboard Table -->
<div class="card shadow-sm">
    <div class="card-body p-0">
        {% if leadertype == 'brands' %}
        <!-- Brands Table -->
        <table class="table table-hover mb-0">
            <thead class="leaderboard-header">
                <tr>
                    <th scope="col" class="text-center">Rank</th>
                    <th scope="col">Brand Name</th>
                    <th scope="col" class="text-center">Avg Rating</th>
                </tr>
            </thead>
            <tbody>
                {% for item in leaderboard_data %}
                <tr>
                    <td class="text-center">
                        <strong class="badge 
                                {% if item.rank == 1 %}bg-warning text-dark
                                {% elif item.rank == 2 %}bg-secondary
                                {% elif item.rank == 3 %}bg-danger
                                {% else %}bg-primary{% endif %}">
                            #{{ item.rank }}
                        </strong>
                    </td>
                    <td><strong>{{ item.brand }}</strong></td>
                    <td class="text-center">
                        <span class="badge bg-success">⭐ {{ item.avg_rating }}</span>
                    </td>
                </tr>
                {% endfor %}

                {% if not leaderboard_data %}
                <tr>
                    <td colspan="3" class="text-center text-muted py-4">
                        No ratings available for brands yet.
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
        {% else %}
        <!-- Drinks Table -->
        <table class="table table-hover mb-0">
            <thead class="leaderboard-header">
                <tr>
                    <th scope="col" class="text-center">Rank</th>
                    <th scope="col">Drink Name</th>
                    <th scope="col" class="text-center">Type</th>
                    <th scope="col" class="text-center">Caffeine (mg)</th>
                    <th scope="col" class="text-center">Avg Rating</th>
                </tr>
            </thead>
            <tbody>
                {% for item in leaderboard_data %}
                <tr>
                    <td class="text-center">
                        <strong class="badge 
                                {% if item.rank == 1 %}bg-warning text-dark
                                {% elif item.rank == 2 %}bg-secondary
                                {% elif item.rank == 3 %}bg-danger
                                {% else %}bg-primary{% endif %}">
                            #{{ item.rank }}
                        </strong>
                    </td>
                    <td><strong>{{ item.drink.name }}</strong></td>
                    <td class="text-center">{{ item.drink.caffeine_type }}</td>
                    <td class="text-center">{{ item.drink.caffeine_amt }} mg</td>
                    <td class="text-center">
                        <span class="badge bg-success">⭐ {{ item.avg_rating }}</span>
                    </td>
                </tr>
                {% endfor %}

                {% if not leaderboard_data %}
                <tr>
                    <td colspan="5" class="text-center text-muted py-4">
                        No ratings available for this category yet.
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
        {% endif %}
    </div>
</div>

{% endblock %}